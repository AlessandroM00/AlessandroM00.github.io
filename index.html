<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Puzzle della Laurea di Alessandro</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #f0f0f0;
      text-align: center;
      padding: 20px;
    }
    h1 {
      color: #333;
    }
    #puzzle-container {
      display: grid;
      grid-template-columns: repeat(3, 100px);
      grid-template-rows: repeat(3, 100px);
      gap: 2px;
      margin: 30px auto;
      width: max-content;
    }
    .piece {
      width: 100px;
      height: 100px;
      background-size: 300px 300px;
      cursor: pointer;
      border: 1px solid #ccc;
    }
    #sticky-section {
      margin-top: 40px;
    }
    .sticky {
      background-color: #fff475;
      padding: 10px;
      border-radius: 8px;
      width: 200px;
      margin: 10px auto;
      font-style: italic;
      box-shadow: 2px 2px 5px rgba(0,0,0,0.2);
    }
    textarea, button {
      margin-top: 10px;
      padding: 10px;
      font-size: 1em;
    }
  </style>
</head>
<body>
  <h1>ðŸŽ“ Completa il puzzle di Alessandro!</h1>

  <div id="puzzle-container"></div>
  <p id="completed-message" style="display:none; font-weight: bold; font-size: 1.2em; color: green;">âœ… Puzzle completato! Ora lascia un messaggio ðŸŽ‰</p>

  <div id="message-form" style="display:none;">
    <textarea id="user-message" placeholder="Scrivi il tuo augurio qui..."></textarea><br>
    <button onclick="addSticky()">ðŸ“Œ Aggiungi il tuo messaggio</button>
  </div>

  <div id="sticky-section"></div>

  <script>
    const container = document.getElementById("puzzle-container");
    let positions = [];

    for (let i = 0; i < 9; i++) {
      positions.push(i);
    }

    // Mescola i pezzi
    positions.sort(() => Math.random() - 0.5);

    for (let i = 0; i < 9; i++) {
      const div = document.createElement("div");
      div.className = "piece";
      const row = Math.floor(positions[i] / 3);
      const col = positions[i] % 3;
      div.style.backgroundImage = "./20240831_184802.jpg"; // Sostituisci con tua foto
      div.style.backgroundPosition = `-${col * 100}px -${row * 100}px`;
      div.setAttribute("data-index", positions[i]);
      div.onclick = () => swapPiece(div);
      container.appendChild(div);
    }

    let firstClick = null;

    function swapPiece(div) {
      if (!firstClick) {
        firstClick = div;
        div.style.border = "2px solid blue";
      } else {
        const index1 = [...container.children].indexOf(firstClick);
        const index2 = [...container.children].indexOf(div);
        container.insertBefore(firstClick, container.children[index2]);
        container.insertBefore(div, container.children[index1]);
        firstClick.style.border = "1px solid #ccc";
        firstClick = null;
        checkCompletion();
      }
    }

    function checkCompletion() {
      const pieces = document.querySelectorAll(".piece");
      let correct = true;
      pieces.forEach((piece, index) => {
        if (piece.getAttribute("data-index") != index) {
          correct = false;
        }
      });
      if (correct) {
        document.getElementById("completed-message").style.display = "block";
        document.getElementById("message-form").style.display = "block";
      }
    }

    function addSticky() {
      const msg = document.getElementById("user-message").value.trim();
      if (msg === "") return;
      const div = document.createElement("div");
      div.className = "sticky";
      div.textContent = msg;
      document.getElementById("sticky-section").appendChild(div);
      document.getElementById("user-message").value = "";
    }
  </script>
</body>
</html>
